<!DOCTYPE html>
<html lang="en">
<!--
   Author: Marek Chalupa <xchalup4@fi.muni.cz>, 2017 - 2018
-->

<script>
function toggleRolling(div) {
  var className = div.getAttribute("class");
  if(className=="rolled") {
    div.className = "unrolled";
  }
  else{
    div.className = "rolled";
  }
}

function toggleRollingByName(name) {
  // XXX: name has been deprecated in HTML5
  var elems = document.getElementsByName(name);
  for (i = 0; i < elems.length; i++) {
  	toggleRolling(elems[i]);
  }
}

</script>

<head>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../style.css">
<style>
    .row {
      background-color: #fefffe;
    }

    .header_row {
      background-color: #889988;
      color: white;
    }

    th {
	    padding: 10px;
    }

    td {
	    padding: 3px;
    }

    td.classif {
	    padding: 0 0 0 0;
    }

    td.count {
#if(@showTimes)
	    padding: 0 1em 0 0;
#else
	    padding: 0 0 0 0;
#end
    }
    
    td.time {
	padding: 0 0 0 1em;
 	border-left: 1px dotted black;
    }

    tr:hover {
      background-color: #f3fff3;
    }

    tr.header_row:hover {
      background-color: #889988;
    }

    tr.stats {
      border: 0;
    }

    .stats {
      border: 0;
      padding: 3px;
    }

    .status-correct {
      color: green;
    }

    .status-incorrect {
      color: red;
    }

    .status-wrong {
      color: red;
    }

    .status-error {
      color: purple;
    }

    .status-unknown {
      color: gray;
    }

    .status-correct-unconfirmed {
      color: orange;
    }
</style>

<title>Benchexec results viewer</title>
</head>

<body>

#include("../header.html")
<script type="text/javascript">
    function toggleSettings(obj) {
        var key = encodeURIComponent(obj.name);
        var value = encodeURIComponent(obj.value);

        var kvp = document.location.search.substr(1).split('&');
        var found = false;
        var i = kvp.length;
        var new_search="";
        while (i--) {
            var x = kvp[i].split('=');
            if (x == '') {
                continue;
            }
            if (x[0] == key) {
                // remove the key from url
                found = true;
                continue;
            } else {
                new_search += "&" + kvp[i];
            }
        }

        if (!found) {
            document.location.search += "&" + key + "=" + value;
        } else {
            document.location.search = new_search;
        }
    }

    function hideTool(tool_id) {
        var kvp = document.location.search.substr(1).split('&');
        var new_search = "";
        var i = kvp.length;

        while (i--) {
            var x = kvp[i].split('=');
            if (x == '') {
                continue;
            }
            if (x[0] == 'run' && x[1] == tool_id) {
                continue;
            } else {
                new_search += "&" + kvp[i];
            }
        }

        document.location.search = new_search;

	// do not continue in following the link
    	return false;
    }

</script>

<div id="content">
  <form name="settingsform" action="/res">
   <input type="checkbox" name="show_times"
#if(@showTimes)
          checked="1"
#end
          onchange="toggleSettings(this)">show times
    (<input type="checkbox" name="show_times_only_solved"
#if(@showTimesOnlySolved)
          checked="1"
#end
          onchange="toggleSettings(this)">solved only)<br>
  </form>

  <table style="margin-top: 15px;">
  <tr class="header_row">
  <th>Category</th>
  #for @run in @runs:
    <th>@run.tool() </br>
    <div onclick="toggleRollingByName('version')"
         class="rolled" name="version"
         style="font-size=10px; font-weight: normal; padding-top:10px; color: #0066ff">
      [@run.getID()] @run.tool_version()</br></br>
      @run.options()</br>
    </div>
    #if(@run.run_description())
      </br>
      @run.run_description()
    #else
      <i>(no descr)</i>
    #end
    <a href="" style="font-size: 10px; color: red;" onclick="return hideTool(@run.getID());">[X]</a>
    <!--<span style="font-size: 10px">[@run.date()]</span>--></th>
  #end
  </tr>


  #for @bset in @benchmarks_sets:
  <tr class="row">
    <td><a href="/benchmarks_results?benchmarks=@{bset.id}@toolsGETList()">@bset.name</a></td>
    #for @run in @runs:
      <td>
      <table class="stats">
      #set @stats = @getStats(@run, @bset.id):
      #for @classif in @classifications:
	  <tr> <td class="classif status-@get(@classif,1)"
	           style="padding-right: 1.5em">@get(@classif,0)</td>
	       <td class="count">@getCount(@stats, @classif)</td>
	       #if(@showTimes)
	       <td class="time">
	         <span style="font-size: 11px">@formatTime(@getTime(@stats, @classif))</span>
               </td>
               #end
	  </tr>
      #end
      </table>
      #if(@showTimes)
      <hr/>
      <table>
      <tr>
      <td> CPU time: </td><td> @formatTime(@stats.getAccTime())</td>
      </tr>
      </table>
      #end
      </td>
    #end
  </tr>
  #end
  </table>
</div> <!-- content -->
</body>

</html>
