<!DOCTYPE html>
<html lang="en">
<!--
   Author: Marek Chalupa <xchalup4@fi.muni.cz>, 2017 - 2018
-->

<script src="../js/brv.js"></script>

<head>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../style.css">
<style>
    abbr {
      border: none !important;
      text-decoration: none !important;
    }
    .row {
      background-color: #fefffe;
      border: 3px solid #efefef;
    }

    .sep-bot > td {
      border-bottom: 1px solid black;
    }

    .row:nth-child(even) {
      background-color: #eeeeee;
    }
    .sep-right {
      border-right: 1px solid black;
    }

    .header_row {
      background-color: #889988;
      color: white;
      border: 3px solid #eeeeee;
    }

    th {
	    padding: 10px;
    }

    td {
	    padding: 3px;
    }

    td.classif {
	    padding: 0 0 0 0;
    }
    td.classif-inline {
      width: 3em;
    }

    .right {
        text-align: right;
    }
    .center {
        text-align: center;
    }

    td.count {
#if(@showTimes)
	    padding: 0 1em 0 0;
#else
	    padding: 0 0 0 0;
#end
    }

    td.stats {
      border: 3px solid #eeeeee;
    }

    td.time {
      padding: 0 0 0 1em;
    }

    tr:hover {
      background-color: #f3fff3;
    }

    tr.header_row:hover {
      background-color: #889988;
    }

    tr.stats {
      border: 0;
    }

    .overall {
        border-top: 10px solid #eeeeee;
    }

    .stats {
      border: 0;
      padding: 3px;
    }

    .status-correct {
      color: green;
    }

    .status-incorrect {
      color: red;
    }

    .status-wrong {
      color: red;
    }

    .status-error {
      color: purple;
    }

    .status-unknown {
      color: gray;
    }

    .status-correct-unconfirmed {
      color: orange;
    }

#if(!@showTimes)
    .row-@lenPlus(@buckets, -1) > td {
      border-bottom: 1px solid black;
    }
#end
    .col-@lenPlus(@buckets, -1) {
      border-right: 1px solid black;
    }
</style>

<title>mamato -- benchexec results viewer </title>
</head>

<body>

#include("../header.html")

  #set @rowspan = @lenPlus(@buckets, 1):
  #if(@showTimes)
    #set @rowspan = @lenPlus(@buckets, 2):
  #end
  #if(@inlineView)
    #set @rowspan = 1:
  #end

  #macro longResultsRow @statsFunc:
        #for @bp in @buckets:
          #set @bucket_id = @get(@bp, 1):
          #set @bucket = @get(@bp, 0):
          <tr class="row row-@bucket_id">
            <td class="sep-right">
              <span class="@bucket.getNameClass()">@bucket.getDisplayName()</span>
            </td>
            #for @run in @runs:
            #set @stats = @statsFunc(@run):
              <td
                class="classif
#if(@showTimes)
right
#else
center
sep-right
#end
                ">
                <span class="@bucket.getNameClass()">
                  <abbr title="@bucket.getDisplayName()">@getBucketCount(@stats, @bucket)</abbr>
                </span>
              </td>
              #if(@showTimes)
                <td class="time sep-right">
                  <span style="font-size: 11px">@formatTime(@getBucketTime(@stats, @bucket))</span>
                </td>
              #end
          #end
          </tr>
        #end

        #if(@showTimes)
          <tr class="sep-bot">
            <td class="sep-right">CPU time:</td>
            #for @run in @runs:
              #set @stats = @statsFunc(@run):
              <td class="center sep-right" colspan="2">
                <span>@formatTime(@stats.getAccTime())</span>
              </td>
            #end
          </tr>
        #end
  #end
  #macro inlineViewRow @statsFunc:
      #for @run in @runs:
        #set @stats = @statsFunc(@run):
        #for @bp in @buckets:
          #set @bucket = @get(@bp, 0):
          <td class="classif classif-inline col-@get(@bp,1) center">
            <span class="@bucket.getNameClass()">
              <abbr title="@bucket.getDisplayName()">@getBucketCount(@stats, @bucket)</abbr>
            </span>
            </td>
        #end
      #end
    </tr>

      #if(@showTimes)
        <tr class="row sep-bot">
          <td class="sep-right">CPU time:</td>
          #for @run in @runs:
            #set @stats = @statsFunc(@run):
            <td class="center sep-right" colspan="
#if(@inlineView)
@lenPlus(@buckets, 0)
#else
2
#end
              ">
              <span>@formatTime(@stats.getAccTime())</span>
            </td>
          #end
        </tr>
      #end
  #end

<div id="content">
  <form name="settingsform" action="/res">
    <select name="grouping" onchange="changeSettings(this)">
#for @grouping in @groupings:
<option 
#if(@get(@grouping, 1) == @groupingId)
                            selected
#end
value="@get(@grouping, 1)">@get(@grouping, 0)</option>
#end
   </select>
   <input type="checkbox" name="inline_view"
#if(@inlineView)
          checked="1"
#end
          onchange="toggleSettings(this)">inline view
   <input type="checkbox" name="show_times"
  #if(@showTimes)
          checked="1"
  #end
          onchange="toggleSettings(this)">show times
    (<input type="checkbox" name="show_times_only_solved"
  #if(@showTimesOnlySolved)
          checked="1"
  #end
          onchange="toggleSettings(this)">solved only)
          <br>
  </form>

  <table cellpadding="0" cellspacing="0" style="margin-top: 15px;">
  <tr class="header_row">
  <th>Category</th>
  #if(!@inlineView)
  <th>Classifications</th>
  #end
  #for @run in @runs:
    <th
#if(@inlineView)
      colspan="@lenPlus(@buckets,0)"
#end
#if(@showTimes)
      colspan="2"
#end
      >@run.tool() </br>
    #if(@run.date())
    @run.date()
    </br>
    #end
    <div onclick="toggleRollingByName('version')"
         class="rolled" name="version"
         style="font-size=10px; font-weight: normal; padding-top:10px; color: #263A26">
      [@run.getID()] @run.tool_version()</br></br>
      @run.options()</br>
    </div>
    #if(@run.run_description())
      </br>
      @run.run_description()
    #else
      <i>(no descr)</i>
    #end
    <a href="" style="font-size: 10px; color: red;" onclick="return hideTool(@run.getID());">[X]</a>
    <!--<span style="font-size: 10px">[@run.date()]</span>--></th>
  #end
  </tr>


  #for @bset in @benchmarks_sets:
    #set @statsFunc = @packStatsFunc(@bset.id):
    <tr class="row
              #if((@inlineView && !@showTimes) || !@inlineView)
                  sep-bot
              #end
      ">
      <td
      #if(@inlineView)
              class="sep-right"
      #end
        rowspan="@rowspan"><a href="/files?benchmarks=@{bset.id}@toolsGETList()">@bset.name</a></td>
      #if(@inlineView)
        #inlineViewRow @statsFunc:
      #end
    </tr>
      #if(!@inlineView)
        #longResultsRow @statsFunc:
      #end
  #end
  <tr class="row sep-bot overall">
    <td
      #if(@inlineView)
              class="sep-right"
      #end
      rowspan="@rowspan">Overall</td>
      #set @statsFunc = @getTotalStats:
      #if(@inlineView)
        #inlineViewRow @statsFunc:
      #end
    </tr>
      #if(!@inlineView)
        #longResultsRow @statsFunc:
      #end
        #if(@inlineView)
        <td class="sep-top"></td>
        #for @run in @runs:
          <td colspan="@lenPlus(@buckets, 1)" class="sep-top">
          </td>
        #end
        #else
          <td colspan="2" class="sep-top"></td>
          #for @run in @runs:
            <td class="sep-top">
              </td>
          #end
        #end
  </table>
</div> <!-- content -->
</body>

</html>
